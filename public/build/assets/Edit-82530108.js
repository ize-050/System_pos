import{u as j,z as v,a as i,c as A,w as f,d as e,t as a,p as C,e as u,f as k,k as r,g as p,h as x,F as g,v as m,s as I,j as S,m as T,x as B}from"./app-3d7f0e19.js";import{A as F}from"./AppLayout-daa2be83.js";/* empty css            */import"./ApplicationLogo-2b775c7a.js";import"./_plugin-vue_export-helper-c27b6911.js";const N={class:"py-12"},M={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},D={class:"bg-white overflow-hidden shadow-sm rounded-lg p-6"},P={class:"text-2xl font-bold mb-6"},E={class:"mb-4"},H=["value"],L={class:"grid grid-cols-2 gap-4 mb-4"},$={class:"mb-4"},z=["onUpdate:modelValue","onChange"],Q=["value"],R=["onUpdate:modelValue"],G=["onUpdate:modelValue"],J={class:"py-2"},K=["onClick"],W={class:"border-t pt-4 mb-4"},X={class:"flex justify-end gap-4 text-sm"},Y={class:"text-right space-y-2"},Z={class:"flex justify-between gap-4"},ee={class:"flex justify-between gap-4 items-center"},te={class:"flex justify-between gap-4 items-center"},se={class:"flex items-center gap-2"},de={class:"flex justify-between gap-4 text-lg font-bold border-t pt-2"},oe={class:"mb-4"},re={class:"flex justify-end gap-2"},le=["disabled"],me={__name:"Edit",props:{purchaseOrder:Object,suppliers:Array,products:Array},setup(c){const n=c,s=j({supplier_id:n.purchaseOrder.supplier_id,order_date:n.purchaseOrder.order_date,expected_delivery_date:n.purchaseOrder.expected_delivery_date,items:n.purchaseOrder.items.map(o=>({product_id:o.product_id,product_name:o.product_name,quantity_ordered:o.quantity_ordered,unit_price:o.unit_price})),discount_amount:n.purchaseOrder.discount_amount||0,include_vat:n.purchaseOrder.vat_amount>0,notes:n.purchaseOrder.notes||""}),w=()=>{s.items.push({product_id:"",product_name:"",quantity_ordered:1,unit_price:0})},V=o=>{s.items.splice(o,1)},O=o=>{const t=n.products.find(d=>d.id===s.items[o].product_id);t&&(s.items[o].product_name=t.name,s.items[o].unit_price=t.cost_price||0)},_=v(()=>s.items.reduce((o,t)=>o+t.quantity_ordered*t.unit_price,0)),h=v(()=>s.include_vat?(_.value-s.discount_amount)*.07:0),U=v(()=>_.value-s.discount_amount+h.value),b=o=>new Intl.NumberFormat("th-TH",{style:"currency",currency:"THB"}).format(o||0),q=()=>{s.put(route("purchase-orders.update",n.purchaseOrder.id),{preserveScroll:!1,onFinish:()=>{s.processing=!1}})};return(o,t)=>(i(),A(F,{title:"แก้ไขใบสั่งซื้อ"},{header:f(()=>[...t[6]||(t[6]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"แก้ไขใบสั่งซื้อ",-1)])]),default:f(()=>[e("div",N,[e("div",M,[e("div",D,[e("h2",P,"แก้ไขใบสั่งซื้อ: "+a(c.purchaseOrder.po_number),1),e("form",{onSubmit:C(q,["prevent"])},[e("div",E,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700"},"ซัพพลายเออร์ *",-1)),u(e("select",{"onUpdate:modelValue":t[0]||(t[0]=d=>r(s).supplier_id=d),required:"",class:"mt-1 block w-full rounded-md border-gray-300"},[t[7]||(t[7]=e("option",{value:""},"เลือกซัพพลายเออร์",-1)),(i(!0),p(g,null,x(c.suppliers,d=>(i(),p("option",{key:d.id,value:d.id},a(d.name),9,H))),128))],512),[[k,r(s).supplier_id]])]),e("div",L,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700"},"วันที่สั่งซื้อ *",-1)),u(e("input",{"onUpdate:modelValue":t[1]||(t[1]=d=>r(s).order_date=d),type:"date",required:"",class:"mt-1 block w-full rounded-md border-gray-300"},null,512),[[m,r(s).order_date]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700"},"วันที่คาดว่าจะได้รับ",-1)),u(e("input",{"onUpdate:modelValue":t[2]||(t[2]=d=>r(s).expected_delivery_date=d),type:"date",class:"mt-1 block w-full rounded-md border-gray-300"},null,512),[[m,r(s).expected_delivery_date]])])]),e("div",$,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Items *",-1)),(i(!0),p(g,null,x(r(s).items,(d,y)=>(i(),p("div",{key:y,class:"flex gap-2 mb-2"},[u(e("select",{"onUpdate:modelValue":l=>d.product_id=l,onChange:l=>O(y),class:"flex-1 rounded-md border-gray-300"},[t[11]||(t[11]=e("option",{value:""},"Select Product",-1)),(i(!0),p(g,null,x(c.products,l=>(i(),p("option",{key:l.id,value:l.id},a(l.name)+" ("+a(l.sku)+") ",9,Q))),128))],40,z),[[k,d.product_id]]),u(e("input",{"onUpdate:modelValue":l=>d.quantity_ordered=l,type:"number",step:"0.01",placeholder:"Qty",class:"w-24 rounded-md border-gray-300"},null,8,R),[[m,d.quantity_ordered,void 0,{number:!0}]]),u(e("input",{"onUpdate:modelValue":l=>d.unit_price=l,type:"number",step:"0.01",placeholder:"Price",class:"w-32 rounded-md border-gray-300"},null,8,G),[[m,d.unit_price,void 0,{number:!0}]]),e("span",J,a(b(d.quantity_ordered*d.unit_price)),1),e("button",{type:"button",onClick:l=>V(y),class:"text-red-600"},"Remove",8,K)]))),128)),e("button",{type:"button",onClick:w,class:"mt-2 text-indigo-600"},"+ Add Item")]),e("div",W,[e("div",X,[e("div",Y,[e("div",Z,[t[13]||(t[13]=e("span",null,"Subtotal:",-1)),e("span",null,a(b(_.value)),1)]),e("div",ee,[t[14]||(t[14]=e("span",null,"Discount:",-1)),u(e("input",{"onUpdate:modelValue":t[3]||(t[3]=d=>r(s).discount_amount=d),type:"number",step:"0.01",min:"0",class:"w-32 rounded-md border-gray-300 text-sm text-right"},null,512),[[m,r(s).discount_amount,void 0,{number:!0}]])]),e("div",te,[e("label",se,[u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=d=>r(s).include_vat=d),type:"checkbox",class:"rounded border-gray-300"},null,512),[[I,r(s).include_vat]]),t[15]||(t[15]=e("span",null,"Include VAT 7%:",-1))]),e("span",null,a(r(s).include_vat?b(h.value):b(0)),1)]),e("div",de,[t[16]||(t[16]=e("span",null,"Total:",-1)),e("span",null,a(b(U.value)),1)])])])]),e("div",oe,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700"},"Notes",-1)),u(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=d=>r(s).notes=d),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300"},null,512),[[m,r(s).notes]])]),e("div",re,[S(r(B),{href:o.route("purchase-orders.show",c.purchaseOrder.id),class:"px-4 py-2 bg-gray-300 rounded-md"},{default:f(()=>[...t[18]||(t[18]=[T("ยกเลิก",-1)])]),_:1},8,["href"]),e("button",{type:"submit",disabled:r(s).processing,class:"px-4 py-2 bg-indigo-600 text-white rounded-md disabled:opacity-50"},"บันทึกการแก้ไข",8,le)])],32)])])])]),_:1}))}};export{me as default};
