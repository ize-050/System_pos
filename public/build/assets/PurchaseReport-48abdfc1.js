import{r as B,a,g as d,d as e,e as k,v as z,f as M,F as y,h,t as c,m as x,z as F,n as C,i as _,c as j,w as H,k as T,x as O,j as A,l as S,G as N}from"./app-cfb3a24f.js";import{A as D}from"./AppLayout-e7d94700.js";/* empty css            */import"./ApplicationLogo-506cd769.js";import"./_plugin-vue_export-helper-c27b6911.js";const E={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6"},L={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4"},U=["value"],P=["value"],R=["value"],I={__name:"PurchaseReportFilters",props:{suppliers:Array,filters:Object},emits:["filter"],setup(l,{emit:w}){var b,$,V,o,r;const u=l,f=w,m=B({start_date:((b=u.filters)==null?void 0:b.start_date)||"",end_date:(($=u.filters)==null?void 0:$.end_date)||"",supplier_id:((V=u.filters)==null?void 0:V.supplier_id)||"",status:((o=u.filters)==null?void 0:o.status)||"",per_page:((r=u.filters)==null?void 0:r.per_page)||50}),p=[{value:"",label:"ทั้งหมด"},{value:"draft",label:"ฉบับร่าง"},{value:"pending",label:"รอดำเนินการ"},{value:"shipping",label:"กำลังจัดส่ง"},{value:"received",label:"รับสินค้าแล้ว"},{value:"cancelled",label:"ยกเลิก"}],v=[25,50,100],g=()=>{f("filter",m.value)},n=()=>{m.value={start_date:"",end_date:"",supplier_id:"",status:"",per_page:50},g()};return(s,t)=>(a(),d("div",E,[e("div",L,[e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," วันที่เริ่มต้น ",-1)),k(e("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>m.value.start_date=i),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[z,m.value.start_date]])]),e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," วันที่สิ้นสุด ",-1)),k(e("input",{"onUpdate:modelValue":t[1]||(t[1]=i=>m.value.end_date=i),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[z,m.value.end_date]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," ซัพพลายเออร์ ",-1)),k(e("select",{"onUpdate:modelValue":t[2]||(t[2]=i=>m.value.supplier_id=i),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[t[7]||(t[7]=e("option",{value:""},"ทั้งหมด",-1)),(a(!0),d(y,null,h(l.suppliers,i=>(a(),d("option",{key:i.id,value:i.id},c(i.name),9,U))),128))],512),[[M,m.value.supplier_id]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," สถานะ ",-1)),k(e("select",{"onUpdate:modelValue":t[3]||(t[3]=i=>m.value.status=i),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[(a(),d(y,null,h(p,i=>e("option",{key:i.value,value:i.value},c(i.label),9,P)),64))],512),[[M,m.value.status]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," แสดงต่อหน้า ",-1)),k(e("select",{"onUpdate:modelValue":t[4]||(t[4]=i=>m.value.per_page=i),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[(a(),d(y,null,h(v,i=>e("option",{key:i,value:i},c(i)+" รายการ ",9,R)),64))],512),[[M,m.value.per_page]])])]),e("div",{class:"mt-4 flex justify-end space-x-3"},[e("button",{onClick:n,type:"button",class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition"}," ล้างตัวกรอง "),e("button",{onClick:g,type:"button",class:"inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition"},[...t[11]||(t[11]=[e("svg",{class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1),x(" กรองข้อมูล ",-1)])])])]))}},G={class:"overflow-x-auto"},K={class:"min-w-full divide-y divide-gray-200"},q={class:"bg-gray-50"},J=["onClick"],Q={class:"flex items-center space-x-1"},W={class:"bg-white divide-y divide-gray-200"},X={key:1,class:"text-gray-900"},Y={key:0},Z=["colspan"],ee={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},te={class:"flex-1 flex justify-between sm:hidden"},se={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},re={class:"text-sm text-gray-700"},le={class:"font-medium"},ae={class:"font-medium"},oe={class:"font-medium"},ne={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},ie={__name:"ReportTable",props:{data:Object,columns:Array},setup(l){const w=l,u=B(""),f=B("asc"),m=F(()=>u.value?[...w.data.data].sort((o,r)=>{const s=p(o,u.value),t=p(r,u.value);return s<t?f.value==="asc"?-1:1:s>t?f.value==="asc"?1:-1:0}):w.data.data),p=(o,r)=>r.split(".").reduce((s,t)=>s==null?void 0:s[t],o),v=o=>{u.value===o?f.value=f.value==="asc"?"desc":"asc":(u.value=o,f.value="asc")},g=(o,r)=>{const s=p(o,r.key);return r.format==="currency"?n(s):r.format==="status"?b(s):r.format==="date"?$(s):s},n=o=>new Intl.NumberFormat("th-TH",{style:"currency",currency:"THB"}).format(o||0),b=o=>({draft:"ฉบับร่าง",pending:"รอดำเนินการ",shipping:"กำลังจัดส่ง",received:"รับสินค้าแล้ว",cancelled:"ยกเลิก"})[o]||o,$=o=>o?new Date(o).toLocaleDateString("th-TH"):"-",V=o=>({draft:"bg-gray-100 text-gray-800",pending:"bg-yellow-100 text-yellow-800",shipping:"bg-blue-100 text-blue-800",received:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"})[o]||"bg-gray-100 text-gray-800";return(o,r)=>(a(),d("div",null,[e("div",G,[e("table",K,[e("thead",q,[e("tr",null,[(a(!0),d(y,null,h(l.columns,s=>(a(),d("th",{key:s.key,scope:"col",class:C(["px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",{"cursor-pointer hover:bg-gray-100":s.sortable}]),onClick:t=>s.sortable?v(s.key):null},[e("div",Q,[e("span",null,c(s.label),1),s.sortable&&u.value===s.key?(a(),d("svg",{key:0,class:C(["w-4 h-4",f.value==="asc"?"transform rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[0]||(r[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2)):_("",!0)])],10,J))),128))])]),e("tbody",W,[(a(!0),d(y,null,h(m.value,s=>(a(),d("tr",{key:s.id,class:"hover:bg-gray-50"},[(a(!0),d(y,null,h(l.columns,t=>(a(),d("td",{key:t.key,class:"px-6 py-4 whitespace-nowrap text-sm"},[t.format==="status"?(a(),d("span",{key:0,class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",V(p(s,t.key))])},c(g(s,t)),3)):(a(),d("span",X,c(g(s,t)),1))]))),128))]))),128)),!m.value||m.value.length===0?(a(),d("tr",Y,[e("td",{colspan:l.columns.length,class:"px-6 py-4 text-center text-sm text-gray-500"}," ไม่พบข้อมูล ",8,Z)])):_("",!0)])])]),l.data.links&&l.data.links.length>3?(a(),d("div",ee,[e("div",te,[l.data.prev_page_url?(a(),j(T(O),{key:0,href:l.data.prev_page_url,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},{default:H(()=>[...r[1]||(r[1]=[x(" ก่อนหน้า ",-1)])]),_:1},8,["href"])):_("",!0),l.data.next_page_url?(a(),j(T(O),{key:1,href:l.data.next_page_url,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},{default:H(()=>[...r[2]||(r[2]=[x(" ถัดไป ",-1)])]),_:1},8,["href"])):_("",!0)]),e("div",se,[e("div",null,[e("p",re,[r[3]||(r[3]=x(" แสดง ",-1)),e("span",le,c(l.data.from),1),r[4]||(r[4]=x(" ถึง ",-1)),e("span",ae,c(l.data.to),1),r[5]||(r[5]=x(" จาก ",-1)),e("span",oe,c(l.data.total),1),r[6]||(r[6]=x(" รายการ ",-1))])]),e("div",null,[e("nav",ne,[(a(!0),d(y,null,h(l.data.links,(s,t)=>(a(),j(T(O),{key:t,href:s.url,class:C([s.active?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50","relative inline-flex items-center px-4 py-2 border text-sm font-medium",t===0?"rounded-l-md":"",t===l.data.links.length-1?"rounded-r-md":""]),innerHTML:s.label},null,8,["href","class","innerHTML"]))),128))])])])])):_("",!0)]))}},de={class:"py-12"},ue={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},me={class:"mb-6 flex justify-between items-center"},ce=["disabled"],ge={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},fe={key:1,class:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},be={class:"mb-6"},pe={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},xe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6"},ve={class:"mt-1 text-3xl font-semibold text-gray-900"},ye={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6"},he={class:"mt-1 text-3xl font-semibold text-gray-900"},we={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6"},ke={class:"mt-1 text-3xl font-semibold text-gray-900"},_e={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6"},$e={class:"mt-1 text-3xl font-semibold text-green-600"},Ve={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Oe={__name:"PurchaseReport",props:{purchaseOrders:Object,summary:Object,suppliers:Array,filters:Object},setup(l){const w=l,u=B(!1),f=[{key:"po_number",label:"เลขที่ใบสั่งซื้อ",sortable:!0},{key:"supplier.name",label:"ซัพพลายเออร์",sortable:!0},{key:"order_date",label:"วันที่สั่งซื้อ",sortable:!0},{key:"subtotal",label:"ยอดรวม",sortable:!0,format:"currency"},{key:"vat_amount",label:"VAT 7%",sortable:!0,format:"currency"},{key:"total_amount",label:"ยอดรวมสุทธิ",sortable:!0,format:"currency"},{key:"status",label:"สถานะ",sortable:!0,format:"status"}],m=g=>{N.get(route("reports.purchases"),g,{preserveState:!0,preserveScroll:!0})},p=async()=>{var g,n;u.value=!0;try{const b=await axios.post(route("reports.export"),{report_type:"purchase",format:"xlsx",filters:w.filters});b.data.success&&(window.location.href=b.data.download_url)}catch(b){alert("เกิดข้อผิดพลาดในการ Export: "+(((n=(g=b.response)==null?void 0:g.data)==null?void 0:n.message)||b.message))}finally{u.value=!1}},v=g=>new Intl.NumberFormat("th-TH",{style:"currency",currency:"THB"}).format(g);return(g,n)=>(a(),j(D,{title:"รายงานยอดซื้อ"},{default:H(()=>[A(T(S),{title:"รายงานยอดซื้อ"}),e("div",de,[e("div",ue,[e("div",me,[n[2]||(n[2]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900"},"รายงานยอดซื้อ"),e("p",{class:"mt-1 text-sm text-gray-600"}," รายงานการสั่งซื้อสินค้าจากซัพพลายเออร์ ")],-1)),e("button",{onClick:p,disabled:u.value,class:"inline-flex items-center px-4 py-2 bg-green-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-900 focus:outline-none focus:border-green-900 focus:ring focus:ring-green-300 disabled:opacity-50 transition"},[u.value?(a(),d("svg",ge,[...n[0]||(n[0]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(a(),d("svg",fe,[...n[1]||(n[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)])])),x(" "+c(u.value?"กำลัง Export...":"Export Excel"),1)],8,ce)]),e("div",be,[A(I,{suppliers:l.suppliers,filters:l.filters,onFilter:m},null,8,["suppliers","filters"])]),e("div",pe,[e("div",xe,[n[3]||(n[3]=e("div",{class:"text-sm font-medium text-gray-500"},"จำนวนใบสั่งซื้อ",-1)),e("div",ve,c(l.summary.total_pos),1)]),e("div",ye,[n[4]||(n[4]=e("div",{class:"text-sm font-medium text-gray-500"},"ยอดรวม",-1)),e("div",he,c(v(l.summary.total_subtotal)),1)]),e("div",we,[n[5]||(n[5]=e("div",{class:"text-sm font-medium text-gray-500"},"VAT รวม",-1)),e("div",ke,c(v(l.summary.total_vat)),1)]),e("div",_e,[n[6]||(n[6]=e("div",{class:"text-sm font-medium text-gray-500"},"ยอดรวมสุทธิ",-1)),e("div",$e,c(v(l.summary.grand_total)),1)])]),e("div",Ve,[A(ie,{data:l.purchaseOrders,columns:f},null,8,["data"])])])])]),_:1}))}};export{Oe as default};
