import{r as A,a,c as p,w as c,d as t,t as o,j as v,m as x,k as g,x as y,i as n,n as E,g as i,h as z,F as H,e as I,v as Q,G as w}from"./app-6a986ce6.js";import{A as G}from"./AppLayout-c0397362.js";/* empty css            */import"./ApplicationLogo-88d45659.js";import"./_plugin-vue_export-helper-c27b6911.js";const O={class:"flex justify-between items-center"},R={class:"font-semibold text-xl text-gray-800 leading-tight"},U={class:"space-x-2"},J={class:"py-12"},K={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},W={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},X={class:"lg:col-span-2 space-y-6"},Y={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Z={class:"p-6"},tt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},et={class:"mt-1 text-sm text-gray-900"},st={class:"mt-1 text-sm text-gray-900"},ot={class:"mt-1 text-sm text-gray-900"},lt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},at={class:"p-6"},dt={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},it={class:"mt-1 text-sm text-gray-900"},nt={class:"mt-1 text-sm text-gray-900"},rt={class:"mt-1 text-sm text-gray-900"},mt={key:0},ut={class:"mt-1 text-sm text-gray-900"},ct={key:1},xt={class:"mt-1 text-sm text-gray-900"},gt={key:1,class:"text-gray-500 text-sm"},yt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ft={class:"p-6"},bt={class:"overflow-x-auto"},ht={class:"min-w-full divide-y divide-gray-200"},pt={class:"bg-white divide-y divide-gray-200"},vt={class:"px-6 py-4 whitespace-nowrap"},wt={class:"flex items-center"},kt={key:0,class:"flex-shrink-0 h-10 w-10"},_t=["src","alt"],jt={class:"ml-4"},Bt={class:"text-sm font-medium text-gray-900"},Ct={key:0,class:"text-sm text-gray-500"},St={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Dt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},$t={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},At={key:0,class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Ft={class:"p-6"},Pt={class:"text-sm text-gray-700"},Tt={class:"space-y-6"},Vt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Lt={class:"p-6"},Mt={class:"space-y-3"},Nt={class:"flex justify-between"},qt={class:"text-sm font-medium text-gray-900"},Et={key:0,class:"flex justify-between"},zt={class:"text-sm font-medium text-blue-600"},Ht={key:1,class:"flex justify-between"},It={class:"text-sm font-medium text-red-600"},Qt={key:2,class:"flex justify-between"},Gt={class:"text-sm font-medium text-gray-900"},Ot={class:"border-t pt-3"},Rt={class:"flex justify-between"},Ut={class:"text-base font-bold text-gray-900"},Jt={class:"border-t pt-3 space-y-2"},Kt={class:"flex justify-between"},Wt={class:"text-sm font-medium text-green-600"},Xt={class:"flex justify-between"},Yt={class:"text-sm font-medium text-blue-600"},Zt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},te={class:"p-6"},ee={class:"space-y-3"},se={class:"flex justify-between"},oe={class:"text-sm font-medium text-gray-900"},le={class:"flex justify-between"},ae={class:"text-sm font-medium text-gray-900"},de={class:"flex justify-between"},ie={class:"text-sm font-medium text-gray-900"},ne={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},re={class:"p-6"},me={class:"space-y-3"},ue={class:"mt-1 text-sm text-gray-900"},ce={key:0},xe={class:"mt-1 text-sm text-gray-900"},ge={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ye={class:"p-6"},fe={class:"space-y-3"},be={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},he={class:"bg-white rounded-lg p-6 w-96"},pe={class:"flex justify-end gap-2"},Be={__name:"Show",props:{sale:Object},setup(s){var j,B,C,S;const r=s;console.log("Sale data:",r.sale),console.log("Sale items:",(j=r.sale)==null?void 0:j.sale_items),console.log("Sale items length:",(C=(B=r.sale)==null?void 0:B.saleItems)==null?void 0:C.length);const m=l=>parseFloat(l||0).toFixed(2),F=l=>({cash:"เงินสด",card:"บัตรเครดิต/เดบิต",bank_transfer:"โอนเงิน",e_wallet:"กระเป๋าเงินอิเล็กทรอนิกส์"})[l]||l,P=l=>({cash:"bg-green-100 text-green-800",card:"bg-blue-100 text-blue-800",bank_transfer:"bg-purple-100 text-purple-800",e_wallet:"bg-orange-100 text-orange-800"})[l]||"bg-gray-100 text-gray-800",T=l=>new Date(l).toLocaleDateString("th-TH",{year:"numeric",month:"short",day:"numeric"}),k=l=>new Date(l).toLocaleDateString("th-TH",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),_=()=>{var l;return((l=r.sale.items)==null?void 0:l.reduce((e,u)=>e+u.quantity,0))||0},V=()=>{const l=r.sale.items||[];if(l.length===0)return 0;const e=l.reduce((d,b)=>d+b.total_price,0),u=_();return u>0?e/u:0},f=A(!1),h=A({email:((S=r.sale.customer)==null?void 0:S.email)||""}),L=()=>{window.open(route("receipts.print",r.sale.id),"_blank")},M=()=>{window.location.href=route("receipts.download-pdf",r.sale.id)},N=()=>{w.post(route("receipts.send-email",r.sale.id),h.value,{onSuccess:()=>{f.value=!1}})},q=()=>{confirm("คุณแน่ใจหรือไม่ที่จะลบการขายนี้? การดำเนินการนี้ไม่สามารถยกเลิกได้")&&w.delete(route("sales.destroy",r.sale.id),{onSuccess:()=>{w.visit(route("sales.index"))}})};return(l,e)=>(a(),p(G,{title:"รายละเอียดการขาย"},{header:c(()=>[t("div",O,[t("h2",R," การขาย #"+o(s.sale.id.toString().padStart(6,"0")),1),t("div",U,[v(g(y),{href:l.route("receipts.preview",s.sale.id),class:"bg-purple-500 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded"},{default:c(()=>[...e[4]||(e[4]=[x(" ดูใบเสร็จ ",-1)])]),_:1},8,["href"]),t("button",{onClick:L,class:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"}," พิมพ์ใบเสร็จ "),t("button",{onClick:M,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}," ดาวน์โหลด PDF "),t("button",{onClick:e[0]||(e[0]=u=>f.value=!0),class:"bg-indigo-500 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded"}," ส่งอีเมล "),l.$page.props.auth.user.role==="admin"||l.$page.props.auth.user.role==="manager"?(a(),p(g(y),{key:0,href:l.route("sales.edit",s.sale.id),class:"bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded"},{default:c(()=>[...e[5]||(e[5]=[x(" แก้ไขการขาย ",-1)])]),_:1},8,["href"])):n("",!0),v(g(y),{href:l.route("sales.index"),class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:c(()=>[...e[6]||(e[6]=[x(" กลับไปยังรายการขาย ",-1)])]),_:1},8,["href"])])])]),default:c(()=>{var u;return[t("div",J,[t("div",K,[t("div",W,[t("div",X,[t("div",Y,[t("div",Z,[e[11]||(e[11]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"ภาพรวมการขาย",-1)),t("div",tt,[t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700"},"รหัสการขาย",-1)),t("p",et,"#"+o(s.sale.id.toString().padStart(6,"0")),1)]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700"},"วันที่ขาย",-1)),t("p",st,o(T(s.sale.created_at)),1)]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700"},"พนักงานขาย",-1)),t("p",ot,o(s.sale.cashier?`${s.sale.cashier.first_name} ${s.sale.cashier.last_name}`:"ไม่ระบุ"),1)]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700"},"วิธีการชำระเงิน",-1)),t("span",{class:E([P(s.sale.payment_method),"mt-1 px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])},o(F(s.sale.payment_method)),3)])])])]),t("div",lt,[t("div",at,[e[17]||(e[17]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"ข้อมูลลูกค้า",-1)),s.sale.customer?(a(),i("div",dt,[t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700"},"ชื่อ",-1)),t("p",it,o(s.sale.customer.name||s.sale.customer.company_name),1)]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700"},"เบอร์โทรศัพท์",-1)),t("p",nt,o(s.sale.customer.phone||"-"),1)]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700"},"อีเมล",-1)),t("p",rt,o(s.sale.customer.email||"-"),1)]),s.sale.customer.customer_type?(a(),i("div",mt,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700"},"ประเภท",-1)),t("p",ut,o(s.sale.customer.customer_type==="individual"?"บุคคลธรรมดา":"นิติบุคคล"),1)])):n("",!0),s.sale.customer.credit_limit?(a(),i("div",ct,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700"},"วงเงินเครดิต",-1)),t("p",xt,"฿"+o(m(s.sale.customer.credit_limit)),1)])):n("",!0)])):(a(),i("div",gt," ลูกค้าทั่วไป (ไม่มีข้อมูลลูกค้า) "))])]),t("div",yt,[t("div",ft,[e[19]||(e[19]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"รายการสินค้า",-1)),t("div",bt,[t("table",ht,[e[18]||(e[18]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," สินค้า "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," ราคาต่อหน่วย "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," จำนวน "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," รวม ")])],-1)),t("tbody",pt,[(a(!0),i(H,null,z(s.sale.sale_items,d=>{var b,D,$;return a(),i("tr",{key:d.id},[t("td",vt,[t("div",wt,[(b=d.product)!=null&&b.image?(a(),i("div",kt,[t("img",{class:"h-10 w-10 rounded-full object-cover",src:d.product.image,alt:d.product.name},null,8,_t)])):n("",!0),t("div",jt,[t("div",Bt,o(((D=d.product)==null?void 0:D.name)||"ไม่พบสินค้า"),1),($=d.product)!=null&&$.category?(a(),i("div",Ct,o(d.product.category.name),1)):n("",!0)])])]),t("td",St," ฿"+o(m(d.unit_price)),1),t("td",Dt,o(d.quantity),1),t("td",$t," ฿"+o(m(d.total_price)),1)])}),128))])])])])]),s.sale.notes?(a(),i("div",At,[t("div",Ft,[e[20]||(e[20]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"หมายเหตุ",-1)),t("p",Pt,o(s.sale.notes),1)])])):n("",!0)]),t("div",Tt,[t("div",Vt,[t("div",Lt,[e[28]||(e[28]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"สรุปการเงิน",-1)),t("div",Mt,[t("div",Nt,[e[21]||(e[21]=t("span",{class:"text-sm text-gray-600"},"ยอดรวมย่อย:",-1)),t("span",qt,"฿"+o(m(s.sale.subtotal)),1)]),s.sale.promotion?(a(),i("div",Et,[e[22]||(e[22]=t("span",{class:"text-sm text-gray-600"},"โปรโมชั่น:",-1)),t("span",zt,o(s.sale.promotion.name),1)])):n("",!0),s.sale.discount_amount>0?(a(),i("div",Ht,[e[23]||(e[23]=t("span",{class:"text-sm text-gray-600"},"ส่วนลด:",-1)),t("span",It,"-฿"+o(m(s.sale.discount_amount)),1)])):n("",!0),s.sale.tax_amount>0?(a(),i("div",Qt,[e[24]||(e[24]=t("span",{class:"text-sm text-gray-600"},"ภาษี:",-1)),t("span",Gt,"฿"+o(m(s.sale.tax_amount)),1)])):n("",!0),t("div",Ot,[t("div",Rt,[e[25]||(e[25]=t("span",{class:"text-base font-medium text-gray-900"},"ยอดรวมทั้งหมด:",-1)),t("span",Ut,"฿"+o(m(s.sale.total_amount)),1)])]),t("div",Jt,[t("div",Kt,[e[26]||(e[26]=t("span",{class:"text-sm text-gray-600"},"จำนวนเงินที่ได้รับ:",-1)),t("span",Wt,"฿"+o(m(s.sale.payment_received)),1)]),t("div",Xt,[e[27]||(e[27]=t("span",{class:"text-sm text-gray-600"},"เงินทอน:",-1)),t("span",Yt,"฿"+o(m(s.sale.change_amount)),1)])])])])]),t("div",Zt,[t("div",te,[e[32]||(e[32]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"สถิติการขาย",-1)),t("div",ee,[t("div",se,[e[29]||(e[29]=t("span",{class:"text-sm text-gray-600"},"จำนวนรายการสินค้า:",-1)),t("span",oe,o(((u=s.sale.items)==null?void 0:u.length)||0),1)]),t("div",le,[e[30]||(e[30]=t("span",{class:"text-sm text-gray-600"},"จำนวนสินค้าทั้งหมด:",-1)),t("span",ae,o(_()),1)]),t("div",de,[e[31]||(e[31]=t("span",{class:"text-sm text-gray-600"},"ราคาเฉลี่ยต่อรายการ:",-1)),t("span",ie,"฿"+o(m(V())),1)])])])]),t("div",ne,[t("div",re,[e[35]||(e[35]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"ข้อมูลเวลา",-1)),t("div",me,[t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700"},"วันที่สร้าง",-1)),t("p",ue,o(k(s.sale.created_at)),1)]),s.sale.updated_at!==s.sale.created_at?(a(),i("div",ce,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium text-gray-700"},"วันที่อัปเดตล่าสุด",-1)),t("p",xe,o(k(s.sale.updated_at)),1)])):n("",!0)])])]),t("div",ge,[t("div",ye,[e[38]||(e[38]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"การดำเนินการ",-1)),t("div",fe,[v(g(y),{href:l.route("sales.receipt",s.sale.id),class:"w-full bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded text-center block transition ease-in-out duration-150",style:{"background-color":"#6B7B47"},onmouseover:"this.style.backgroundColor='#8A9B5A'",onmouseout:"this.style.backgroundColor='#6B7B47'",target:"_blank"},{default:c(()=>[...e[36]||(e[36]=[x(" พิมพ์ใบเสร็จ ",-1)])]),_:1},8,["href"]),l.$page.props.auth.user.role==="admin"||l.$page.props.auth.user.role==="manager"?(a(),p(g(y),{key:0,href:l.route("sales.edit",s.sale.id),class:"w-full text-white font-bold py-2 px-4 rounded text-center block transition ease-in-out duration-150",style:{"background-color":"#6B7B47"},onmouseover:"this.style.backgroundColor='#8A9B5A'",onmouseout:"this.style.backgroundColor='#6B7B47'"},{default:c(()=>[...e[37]||(e[37]=[x(" แก้ไขการขาย ",-1)])]),_:1},8,["href"])):n("",!0),l.$page.props.auth.user.role==="admin"?(a(),i("button",{key:1,onClick:e[1]||(e[1]=d=>q()),class:"w-full bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded"}," ลบการขาย ")):n("",!0)])])])])])])]),f.value?(a(),i("div",be,[t("div",he,[e[39]||(e[39]=t("h3",{class:"text-lg font-bold mb-4"},"ส่งใบเสร็จทางอีเมล",-1)),I(t("input",{"onUpdate:modelValue":e[2]||(e[2]=d=>h.value.email=d),type:"email",placeholder:"กรอกอีเมล",required:"",class:"w-full rounded-md border-gray-300 mb-4"},null,512),[[Q,h.value.email]]),t("div",pe,[t("button",{onClick:e[3]||(e[3]=d=>f.value=!1),class:"px-4 py-2 bg-gray-300 rounded-md"},"ยกเลิก"),t("button",{onClick:N,class:"px-4 py-2 bg-indigo-600 text-white rounded-md"},"ส่ง")])])])):n("",!0)]}),_:1}))}};export{Be as default};
