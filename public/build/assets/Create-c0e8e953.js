import{u as E,r as w,D as $,b as N,E as j,a as d,c as B,w as f,d as t,j as F,m as T,k as l,x as A,p as M,e as a,v as i,g as u,F as k,h as S,t as r,i as _,f as O}from"./app-cfb3a24f.js";import{A as D}from"./AppLayout-e7d94700.js";/* empty css            */import"./ApplicationLogo-506cd769.js";import"./_plugin-vue_export-helper-c27b6911.js";const Q={class:"flex justify-between items-center"},R={class:"py-12"},L={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},W={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},z={class:"lg:col-span-2"},G={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},H={class:"p-6"},J={class:"mb-4"},K={key:0,class:"mb-6 max-h-60 overflow-y-auto border rounded-md"},X=["onClick"],Y={class:"font-medium"},Z={class:"text-sm text-gray-500"},tt={key:1},et={class:"space-y-3"},ot={class:"flex-1"},st={class:"font-medium"},nt={class:"text-sm text-gray-500"},lt={class:"flex items-center space-x-2"},at=["onClick"],rt=["onUpdate:modelValue","max","onInput"],dt=["onClick"],it={class:"text-right"},ut={class:"font-medium"},mt=["onClick"],ct={key:2,class:"text-center py-8 text-gray-500"},pt={class:"space-y-6"},yt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},bt={class:"p-6"},gt={class:"space-y-4"},xt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},vt={class:"p-6"},ft={class:"space-y-3"},_t={class:"flex justify-between"},ht={class:"flex justify-between items-center"},wt={class:"flex justify-between items-center"},kt={class:"border-t pt-3"},St={class:"flex justify-between text-lg font-bold"},Ct={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},qt={class:"p-6"},Vt={class:"space-y-4"},Pt={key:0,class:"text-red-600 text-sm mt-1"},It={key:0,class:"text-red-600 text-sm mt-1"},Ut={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Et={class:"p-6"},$t=["disabled"],At={__name:"Create",props:{errors:Object},setup(x){const o=E({customer_name:"",customer_phone:"",customer_email:"",items:[],subtotal:0,tax_amount:0,discount_amount:0,total_amount:0,payment_method:"",payment_received:0,change_amount:0,notes:""}),c=w(""),p=w([]),C=$.debounce(async()=>{if(c.value.length>=2)try{const n=await N.get(route("sales.search-products"),{params:{search:c.value}});p.value=n.data}catch(n){console.error("Error searching products:",n),p.value=[]}else p.value=[]},300);j(c,C);const q=n=>{const e=o.items.findIndex(s=>s.product_id===n.id);e>=0?o.items[e].quantity<n.stock_quantity?(o.items[e].quantity+=1,v(e)):alert("Cannot add more items. Stock limit reached."):o.items.push({product_id:n.id,product_name:n.name,quantity:1,unit_price:n.selling_price,total_price:n.selling_price,max_quantity:n.stock_quantity}),m(),c.value="",p.value=[]},V=n=>{o.items.splice(n,1),m()},P=n=>{const e=o.items[n];e.quantity<e.max_quantity?(e.quantity+=1,v(n),m()):alert("Cannot add more items. Stock limit reached.")},I=n=>{const e=o.items[n];e.quantity>1&&(e.quantity-=1,v(n),m())},v=n=>{const e=o.items[n];e.total_price=e.quantity*e.unit_price,m()},m=()=>{o.subtotal=o.items.reduce((n,e)=>n+e.total_price,0),o.total_amount=o.subtotal+(o.tax_amount||0)-(o.discount_amount||0),h()},h=()=>{o.change_amount=Math.max(0,(o.payment_received||0)-o.total_amount)},b=n=>parseFloat(n||0).toFixed(2),U=()=>{if(o.items.length===0){alert("Please add at least one item to the sale.");return}o.post(route("sales.store"),{onSuccess:()=>{}})};return(n,e)=>(d(),B(D,{title:"New Sale"},{header:f(()=>[t("div",Q,[e[11]||(e[11]=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," New Sale ",-1)),F(l(A),{href:n.route("sales.index"),class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:f(()=>[...e[10]||(e[10]=[T(" Back to Sales ",-1)])]),_:1},8,["href"])])]),default:f(()=>[t("div",R,[t("div",L,[t("form",{onSubmit:M(U,["prevent"])},[t("div",W,[t("div",z,[t("div",G,[t("div",H,[e[14]||(e[14]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Product Selection",-1)),t("div",J,[a(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),type:"text",placeholder:"Search products by name or barcode...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none transition ease-in-out duration-150",style:{"border-color":"#E2E8F0"},onfocus:"this.style.borderColor='#6B7B47'; this.style.boxShadow='0 0 0 3px rgba(107, 123, 71, 0.2)'",onblur:"this.style.borderColor='#E2E8F0'; this.style.boxShadow='none'"},null,512),[[i,c.value]])]),p.value.length>0?(d(),u("div",K,[(d(!0),u(k,null,S(p.value,s=>(d(),u("div",{key:s.id,onClick:y=>q(s),class:"p-3 border-b hover:bg-gray-50 cursor-pointer flex justify-between items-center"},[t("div",null,[t("div",Y,r(s.name),1),t("div",Z," Stock: "+r(s.stock_quantity)+" | Price: $"+r(b(s.selling_price)),1)]),e[12]||(e[12]=t("button",{type:"button",class:"bg-blue-500 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm"}," Add ",-1))],8,X))),128))])):_("",!0),l(o).items.length>0?(d(),u("div",tt,[e[13]||(e[13]=t("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Selected Items",-1)),t("div",et,[(d(!0),u(k,null,S(l(o).items,(s,y)=>(d(),u("div",{key:y,class:"flex items-center space-x-3 p-3 border rounded-md"},[t("div",ot,[t("div",st,r(s.product_name),1),t("div",nt,"Price: $"+r(b(s.unit_price)),1)]),t("div",lt,[t("button",{type:"button",onClick:g=>I(y),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-2 py-1 rounded"}," - ",8,at),a(t("input",{"onUpdate:modelValue":g=>s.quantity=g,type:"number",min:"1",max:s.max_quantity,onInput:g=>v(y),class:"w-16 px-2 py-1 border border-gray-300 rounded text-center"},null,40,rt),[[i,s.quantity,void 0,{number:!0}]]),t("button",{type:"button",onClick:g=>P(y),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-2 py-1 rounded"}," + ",8,dt)]),t("div",it,[t("div",ut,"$"+r(b(s.total_price)),1)]),t("button",{type:"button",onClick:g=>V(y),class:"text-red-600 hover:text-red-900"}," Remove ",8,mt)]))),128))])])):(d(),u("div",ct," Search and select products to add to the sale "))])])]),t("div",pt,[t("div",yt,[t("div",bt,[e[18]||(e[18]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Customer Information",-1)),t("div",gt,[t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Customer Name ",-1)),a(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>l(o).customer_name=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional"},null,512),[[i,l(o).customer_name]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Phone Number ",-1)),a(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>l(o).customer_phone=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional"},null,512),[[i,l(o).customer_phone]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Email ",-1)),a(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>l(o).customer_email=s),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional"},null,512),[[i,l(o).customer_email]])])])])]),t("div",xt,[t("div",vt,[e[23]||(e[23]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Sale Summary",-1)),t("div",ft,[t("div",_t,[e[19]||(e[19]=t("span",null,"Subtotal:",-1)),t("span",null,"$"+r(b(l(o).subtotal)),1)]),t("div",ht,[e[20]||(e[20]=t("label",{class:"text-sm font-medium text-gray-700"}," Discount Amount: ",-1)),a(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>l(o).discount_amount=s),type:"number",min:"0",step:"0.01",onInput:m,class:"w-24 px-2 py-1 border border-gray-300 rounded text-right"},null,544),[[i,l(o).discount_amount,void 0,{number:!0}]])]),t("div",wt,[e[21]||(e[21]=t("label",{class:"text-sm font-medium text-gray-700"}," Tax Amount: ",-1)),a(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>l(o).tax_amount=s),type:"number",min:"0",step:"0.01",onInput:m,class:"w-24 px-2 py-1 border border-gray-300 rounded text-right"},null,544),[[i,l(o).tax_amount,void 0,{number:!0}]])]),t("div",kt,[t("div",St,[e[22]||(e[22]=t("span",null,"Total:",-1)),t("span",null,"$"+r(b(l(o).total_amount)),1)])])])])]),t("div",Ct,[t("div",qt,[e[29]||(e[29]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Payment Information",-1)),t("div",Vt,[t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Payment Method * ",-1)),a(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>l(o).payment_method=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},[...e[24]||(e[24]=[t("option",{value:""},"Select Payment Method",-1),t("option",{value:"cash"},"Cash",-1),t("option",{value:"card"},"Card",-1),t("option",{value:"bank_transfer"},"Bank Transfer",-1),t("option",{value:"e_wallet"},"E-Wallet",-1)])],512),[[O,l(o).payment_method]]),x.errors.payment_method?(d(),u("div",Pt,r(x.errors.payment_method),1)):_("",!0)]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Payment Received * ",-1)),a(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>l(o).payment_received=s),type:"number",min:"0",step:"0.01",onInput:h,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,544),[[i,l(o).payment_received,void 0,{number:!0}]]),x.errors.payment_received?(d(),u("div",It,r(x.errors.payment_received),1)):_("",!0)]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Change Amount ",-1)),a(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>l(o).change_amount=s),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100",readonly:""},null,512),[[i,l(o).change_amount]])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Notes ",-1)),a(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=s=>l(o).notes=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional notes..."},null,512),[[i,l(o).notes]])])])])]),t("div",Ut,[t("div",Et,[t("button",{type:"submit",disabled:l(o).items.length===0||l(o).processing,class:"w-full bg-green-500 hover:bg-green-700 disabled:bg-gray-400 text-white font-bold py-3 px-4 rounded text-lg"},r(l(o).processing?"Processing...":"Complete Sale"),9,$t)])])])])],32)])])]),_:1}))}};export{At as default};
